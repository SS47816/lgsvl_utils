
<launch>
  <!-- ROS-Bridge node for Simulator connection -->
  <node name="websocket_bridge" pkg="rosbridge_server" type="rosbridge_websocket" output="screen" clear_params="true" required="true" />

  <!-- Re-publishing simulator/camera_node/image/compressed topic to /image_raw as expected by Autoware -->
  <node name="republish" type="republish" pkg="image_transport" output="screen" args="compressed in:=/simulator/camera_node/image raw out:=/image_raw" />

  <!-- TF -->
  <include file="$(env HOME)/shared_dir/autoware-data/BorregasAve/data/tf/tf.launch"/>
  <node pkg="tf" type="static_transform_publisher" name="base_link_to_gps" args="0 0 0 0 0 0 /base_link /gps 10"/>
  <node pkg="tf" type="static_transform_publisher" name="base_link_to_imu" args="0 0 0 0 0 0 /base_link /imu 10"/>
  <node pkg="tf" type="static_transform_publisher" name="base_link_to_velodyne" args="1 0 1.5 0 0 0 /base_link /velodyne 10"/>
  <node pkg="tf" type="static_transform_publisher" name="base_link_to_camera" args="1.5 0 1.2 0 0 0 /base_link /camera 10" />

  <!-- Point Cloud -->
  <!-- Note: this is generated from simulator -->
  <include file="$(find map_file)/launch/points_map_loader.launch">
    <arg name="path_pcd" value="$(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/pointcloud_map/BorregasAve.pcd" />
  </include>

  <!-- Vector Map -->
  <node pkg="map_file" type="vector_map_loader" name="vector_map_loader" args="
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/lane.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/dtlane.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/point.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/line.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/pole.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/signaldata.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/stopline.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/vector.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/whiteline.csv
    $(env HOME)/shared_dir/autoware-data/BorregasAve/data/map/vector_map/node.csv" 
  />

  <!-- Ground Truth Viewer -->
  <node pkg="lgsvl_utils" type="gt_viewer_node" name="gt_viewer_node" output="screen">
    <param name="lgsvl_gt3d_topic"        value="/simulator/ground_truth/3d_detections" />
    <param name="jsk_bboxes_topic"        value="/simulator/ground_truth/jsk_bounding_boxes" />
    <param name="autoware_objects_topic"  value="/simulator/ground_truth/autoware_detected_objects" />
    <param name="bbox_target_frame"       value="base_link" />
    <param name="bbox_filter_size"        value="10.0" />
  </node>

  <!-- Localizer -->
  <node pkg="lgsvl_utils" type="localizer_node" name="localizer_node" output="screen">
    <param name="lgsvl_odom_topic"        value="/simulator/ground_truth/odom" />
    <param name="map_frame"               value="map" />
    <param name="baselink_frame"          value="base_link" />
  </node>

  <!-- rviz -->
  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find lgsvl_utils)/rviz/lgsvl.rviz" />
  
</launch>